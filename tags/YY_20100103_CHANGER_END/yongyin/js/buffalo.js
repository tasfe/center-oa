/*
 * Compressed by JSA(www.xidea.org)
 */
var Buffalo=Class.create();Buffalo.BOCLASS="_BUFFALO_OBJECT_CLASS_";Buffalo.VERSION="2.0";Buffalo.prototype={initialize:function(_,A,$,B){this.gateway=_;this.transport=null;if(typeof(A)=="undefined")this.async=true;else this.async=A;this.currentCallback=new Function();this.setEvents($);this.queue=[];this.requesting=false;this.options={timeout:30000};Object.extend(this.options,B||{})},getGateway:function(){return this.gateway},setEvents:function($){this.events={onLoading:Buffalo.Default.showLoading,onFinish:new Function(),onException:null,onError:Buffalo.Default.showError,onTimeout:new Function()};Object.extend(this.events,$||{})},_remoteCall:function(A,_,$){this.requesting=true;this.transport=XmlHttp.create();try{this.transport.open("POST",A,this.async);this.transport.setRequestHeader("X-Buffalo-Version",Buffalo.VERSION);this.transport.setRequestHeader("Content-Type","text/xml;charset=utf-8");this.transport.send(_.xml())}catch(B){this.events.onError(this.transport);this.events["onLoading"](false);return}this.requestTime=new Date();this.timeoutHandle=new PeriodicalExecuter(this._timeoutChecker.bind(this),0.5);this.currentCallback=$;if(this.async){this.transport.onreadystatechange=this.onStateChange.bind(this);this.events["onLoading"](true)}else this.response()},_timeoutChecker:function(){if((new Date()-this.requestTime)>this.options.timeout){this.events["onTimeout"]();this.timeoutHandle.stop()}},nextRemoteCall:function(){if(this.queue.length<=0)return;var $=this.queue.shift();this._remoteCall($.url,$.call,$.callback)},remoteCall:function(_,C,A){var E=this._splitServiceMethod(_),D=this.gateway+"/buffalo/"+E[0],B=new Buffalo.Call(E[1]);for(var $=0;$<C.length;$++)B.addParameter(C[$]);this.queue.push({url:D,call:B,callback:A});if(!this.requesting)this.nextRemoteCall()},_splitServiceMethod:function($){var A=$.lastIndexOf("."),_=$.substring(0,A),B=$.substring(A+1,$.length);return[_,B]},onStateChange:function(){if(this.transport.readyState==4)this.response()},response:function(){this.timeoutHandle.stop();this.events["onLoading"](false);if(this.transport.responseText&&this.transport.status=="200"){var $=new Buffalo.Reply(this.transport);if($.isFault()){if(this.events["onException"])this.events["onException"]($.getResult());else{Buffalo.Default.showException($.getResult());this.currentCallback($)}}else this.currentCallback($);this.events["onFinish"]($);this.requesting=false;this.nextRemoteCall()}else{this.events["onError"](this.transport);this.requesting=false}}};Buffalo.Default={loadingPane:null,errorPane:null,exceptionPane:null,showLoading:function(A){this.loadingPane=$("buffalo_loading");if(this.loadingPane==null){var _=document.createElement("DIV");_.setAttribute("id","buffalo_loading");_.style.cssText="display:none;font-family:Verdana;font-size:11px;border:1px solid #00CC00;background-color:#A4FFA4;padding:1px;position:absolute; right:1px; top:1px; width:110px; height:14px; z-index:10000";_.innerHTML="buffalo loading... ";this.loadingPane=_}if(A){this.loadingPane.style.display="block";window.status="loading...";this.loadingPane.style.top=document.body.scrollTop+1}else{this.loadingPane.style.display="none";window.status="complate"}},showError:function(A){this.errorPane=$("buffalo_error");if(this.errorPane==null){var _=document.createElement("DIV");_.setAttribute("id","buffalo_error");_.style.cssText="font-size:11px;border:4px solid #FF3333;background-color:#fff;padding:4px;position:absolute;overflow:auto; right:10px; top:10px; width:500px; height:300px; z-index:1";_.innerHTML="<h2>Error: "+A.status+" - "+A.statusText+"</h2>";_.innerHTML+="<textarea style='width:96%;height:80%'>"+A.responseText.stripTags()+"</textarea>";_.onclick=function(){_.style.display="none"};document.body.appendChild(_);this.errorPane=_}else this.errorPane.style.display="block"},showException:function(_){this.exceptionPane=$("buffalo_exception");if(this.exceptionPane==null){var A=document.createElement("DIV");A.setAttribute("id","buffalo_exception");A.style.cssText="font-size:11px;border:4px solid #FFFF33;background-color:#fff;padding:4px;position:absolute;overflow:auto; right:10px; top:10px; width:300px; height:100px; z-index:1";A.innerHTML="<h2>Exception: "+_.code+"</h2>";A.innerHTML+="Code: "+_.code+"<br/>";A.innerHTML+="Message: "+_.message+"<br/>";A.innerHTML+="Detail: "+_.detail;A.onclick=function(){A.style.display="none"};this.exceptionPane=A}else this.exceptionPane.style.display="block"},showTimeout:function(){alert("timeout!")}};function getDomDocumentPrefix(){if(getDomDocumentPrefix.prefix)return getDomDocumentPrefix.prefix;var A=["MSXML2","Microsoft","MSXML","MSXML3"],$;for(var _=0;_<A.length;_++){try{$=new ActiveXObject(A[_]+".DomDocument");return getDomDocumentPrefix.prefix=A[_]}catch(B){}}throw new Error("Could not find an installed XML parser")}function getXmlHttpPrefix(){if(getXmlHttpPrefix.prefix)return getXmlHttpPrefix.prefix;var A=["MSXML2","Microsoft","MSXML","MSXML3"],$;for(var _=0;_<A.length;_++){try{$=new ActiveXObject(A[_]+".XmlHttp");return getXmlHttpPrefix.prefix=A[_]}catch(B){}}throw new Error("Could not find an installed XMLHttp object")}function XmlHttp(){}XmlHttp.create=function(){try{if(window.XMLHttpRequest){var $=new XMLHttpRequest();if($.readyState==null){$.readyState=1;$.addEventListener("load",function(){$.readyState=4;if(typeof $.onreadystatechange=="function")$.onreadystatechange()},false)}return $}if(window.ActiveXObject)return new ActiveXObject(getXmlHttpPrefix()+".XmlHttp")}catch(_){}throw new Error("Your browser does not support XmlHttp objects")};function XmlDocument(){}XmlDocument.create=function(){try{if(document.implementation&&document.implementation.createDocument){var $=document.implementation.createDocument("","",null);if($.readyState==null){$.readyState=1;$.addEventListener("load",function(){$.readyState=4;if(typeof $.onreadystatechange=="function")$.onreadystatechange()},false)}return $}if(window.ActiveXObject)return new ActiveXObject(getDomDocumentPrefix()+".DomDocument")}catch(_){}throw new Error("Your browser does not support XmlDocument objects")};if(window.DOMParser&&window.XMLSerializer&&window.Node&&Node.prototype&&Node.prototype.__defineGetter__){Document.prototype.loadXML=function(A){var _=(new DOMParser()).parseFromString(A,"text/xml");while(this.hasChildNodes())this.removeChild(this.lastChild);for(var $=0;$<_.childNodes.length;$++)this.appendChild(this.importNode(_.childNodes[$],true))};Document.prototype.__defineGetter__("xml",function(){return(new XMLSerializer()).serializeToString(this)})}Buffalo.Call=Class.create();Buffalo.Call.prototype={initialize:function($){this.method=$;this.params=[];this._objects=[]},addParameter:function($){if(typeof($)=="undefined")return;this.params[this.params.length]=$},xml:function(){this._objects=[];var A="<buffalo-call>\n";A+="<method>"+this.method+"</method>\n";for(var $=0;$<this.params.length;$++){var _=this.params[$];A+=this.getParamXML(this.dataTypeOf(_),_)+"\n"}A+="</buffalo-call>";return A},dataTypeOf:function($){if($==null)return"null";var _=typeof($);_=_.toLowerCase();switch(_){case"number":_=this._getNumberType($);break;case"object":var A=$.constructor;if(A==Date)_="date";else if(A==Array)_="list";else _="map";break}return _},_getNumberType:function($){if(Math.round($)==$)return"int";else return"double"},doValueXML:function($,_){var A,B=_;if(typeof(_)=="string"){B=B.replace(/&/g,"&amp;");B=B.replace(/</g,"&lt;");B=B.replace(/>/g,"&gt;");A="<"+$+">"+B+"</"+$+">"}else A="<"+$+">"+_+"</"+$+">";return A},doBooleanXML:function(_){var $=(_==true)?1:0,A="<boolean>"+$+"</boolean>";return A},doDateXML:function($){var _="<date>";_+=dateToISO8609($);_+="</date>";return _},doArrayXML:function(B){var A=this._checkRef(B);if(A!=-1)return"<ref>"+A+"</ref>";this._objects[this._objects.length]=B;var D="<list>\n",C=B[Buffalo.BOCLASS],_=C?C:this.arrayType(B);D+="<type>"+_+"</type>\n";D+="<length>"+B.length+"</length>\n";for(var $=0;$<B.length;$++)D+=this.getParamXML(this.dataTypeOf(B[$]),B[$])+"\n";D+="</list>\n";return D},arrayType:function(E){if(E.length==0)return"";var D="",B=E;while(this.isArray(B)){var C=B[0],A=true;for(var _=0;_<B.length;_++){var F=B[_];if(typeof(F)!=typeof(C)){A=false;break}else{if(typeof(F)=="object")if(C[Buffalo.BOCLASS]!=F[Buffalo.BOCLASS]){A=false;break}if(typeof(F)=="number")if(this._getNumberType(F)!=this._getNumberType(C)){A=false;break}}}if(A){D+="[";B=B[0]}else break}if(D.indexOf("[")==-1)return"";var $=B[Buffalo.BOCLASS]||typeof(B);if($=="object")return"";if($=="number")$=this._getNumberType(B);return D+$},isArray:function($){return typeof($)=="object"&&$.constructor==Array},_checkRef:function(_){var A=-1;for(var $=0;$<this._objects.length;$++)if(_===this._objects[$]){A=$;break}return A},doStructXML:function(B){var A=this._checkRef(B);if(A!=-1)return"<ref>"+A+"</ref>";this._objects[this._objects.length]=B;var _=B[Buffalo.BOCLASS]||"java.util.HashMap",C="<map>\n";C+="<type>"+_+"</type>\n";for(var $ in B)if(B[$]!=_){if(typeof(B[$])=="function")continue;C+=this.getParamXML(this.dataTypeOf($),$)+"\n";C+=this.getParamXML(this.dataTypeOf(B[$]),B[$])+"\n"}C+="</map>\n";return C},doNullXML:function(){return"<null></null>"},getParamXML:function($,_){var A;switch($){case"date":A=this.doDateXML(_);break;case"list":A=this.doArrayXML(_);break;case"map":A=this.doStructXML(_);break;case"boolean":A=this.doBooleanXML(_);break;case"null":A=this.doNullXML();break;default:A=this.doValueXML($,_);break}return A}};function dateToISO8609(D){var B=D.getYear();if(B<2000)B+=1900;var $=leadingZero(new String(D.getMonth()+1)),_=leadingZero(new String(D.getDate())),C=leadingZero(new String(D.getHours()))+leadingZero(new String(D.getMinutes()))+leadingZero(new String(D.getSeconds())),A=B+$+_+"T"+C+"Z";return A}function leadingZero($){if($.length==1)$="0"+$;return $}Buffalo.Reply=Class.create();Buffalo.Reply.prototype={initialize:function($){this._isFault=false;this._type="null";this._objects=[];this._objectNodes=[];this._source=$.responseText;var _=$.responseXML?$.responseXML.documentElement:this.constructNodeFromXmlStringInIEOrFF(this._source);this.dataNode=_.firstChild;this._type=this._getType(this.dataNode)},constructNodeFromXmlStringInIEOrFF:function($){var _=XmlDocument.create();_.async=false;_.loadXML($);return _.documentElement},getType:function(){return this._type},getResult:function(){return this.deserialize(this.dataNode)},isFault:function(){return(this._type=="fault")},isNull:function(){return(this._type=="null")},getSource:function(){return this._source},deserialize:function(_){var A,$=this._getType(_);switch($){case"boolean":A=this.doBoolean(_);break;case"date":A=this.doDate(_);break;case"double":A=this.doDouble(_);break;case"int":case"long":A=this.doInt(_);break;case"list":A=this.doList(_);break;case"map":A=this.doMap(_);break;case"null":A=this.doNull(_);break;case"ref":A=this.doRef(_);break;case"string":A=this.doString(_);break;case"xml":A=this.doXML(_);break;case"fault":A=this.doFault(_);break;default:}return A},_getType:function($){return $.tagName.toLowerCase()},getNodeText:function(_){if(_&&_.hasChildNodes()){var A="";for(var $=0;$<_.childNodes.length;$++)A+=new String(_.childNodes.item($).nodeValue);return A}else return null},doBoolean:function(_){var $=this.getNodeText(_);return($=="1")},doDate:function(E){var F=this.getNodeText(E),C=parseInt(F.substring(0,4),"10"),_=parseInt(F.substring(4,6),"10")-1,B=parseInt(F.substring(6,8),"10"),A=parseInt(F.substring(9,11),"10"),D=parseInt(F.substring(11,13),"10"),G=parseInt(F.substring(13,15),"10"),$=new Date(C,_,B,A,D,G);return $},doDouble:function(_){var $=this.getNodeText(_);return parseFloat($)},doInt:function(_){var $=this.getNodeText(_);return parseInt($)},doList:function(_){var A=new Array();this._objects[this._objects.length]=A;var B=_.childNodes;A[Buffalo.BOCLASS]=this.getNodeText(B[0]);for(var $=2;$<B.length;$++)A[A.length]=this.deserialize(B[$]);return A},doMap:function(A){var _=new Object();this._objects[this._objects.length]=_;var B=A.childNodes;_[Buffalo.BOCLASS]=this.getNodeText(B[0]);for(var $=1;$<B.length;$+=2)_[this.getNodeText(B[$])]=this.deserialize(B[$+1]);return _},doNull:function($){return null},doRef:function(A){var $=this.getNodeText(A),_=parseInt($);return this._objects[_]},doString:function(_){var $=this.getNodeText(_);if($==null)return"";return($)},doXML:function(_){var $=this.getNodeText(_);return unescape($)},doFault:function(B){var $=this.getNodeText(B.childNodes[1]),A=this.getNodeText(B.childNodes[3]),_=this.deserialize(B.childNodes[5]);return new Buffalo.Fault($,A,_)}};Buffalo.Fault=Class.create();Buffalo.Fault.prototype={initialize:function($,A,_){this.code=$;this.message=A;this.detail=_},toString:function(){return"Buffalo.Fault:[code="+this.code+", message="+this.message+", detail="+this.detail+"]"}};Object.extend(Buffalo.prototype,{bindReply:function($,_,A,B){this.remoteCall($,_,function($){Buffalo.Bind.bind(A,$.getResult(),B)})}});Buffalo.Bind={bind:function(A,B,C){var _=$(A);switch(_.tagName){case"INPUT":switch(_.type.toLowerCase()){case"text":case"hidden":case"password":Buffalo.BindFactory.bindText(_,B);break;case"checkbox":case"radio":Buffalo.BindFactory.bindRadioOrCheckbox(_,B);break}break;case"TEXTAREA":Buffalo.BindFactory.bindText(_,B);break;case"TABLE":Buffalo.BindFactory.bindTable(_,B);break;case"SELECT":Buffalo.BindFactory.bindSelect(_,B,C);break;case"DIV":case"SPAN":_.innerHTML=B;break;case"FORM":Buffalo.Form.bindForm(_,B)}}};Buffalo.BindFactory={reportError:function(_,$,A){throw"Data bind failed: "+A},bindText:function(_,$){_.value=$},bindRadioOrCheckbox:function(_,$){_.checked=Buffalo.BindFactory.checkTrue($)},bindSelect:function(A,_,D){if(typeof(_)!="object"||_.constructor!=Array)this.reportError(A,_,"Array Type Needed for binding select!");while(A.childNodes.length>0)A.removeChild(A.childNodes[0]);for(var $=0;$<_.length;$++){var B=document.createElement("OPTION");if(D&&D.binder)D.binder(_,B,$);else{var C=_[$];if(typeof(C)!="object"){B.value=C;B.text=C}else{B.value=C[A.getAttribute("jvalue")];B.text=C[A.getAttribute("jtext")];if(Buffalo.BindFactory.checkTrue(C.selected))B.selected=true}}A.options.add(B)}},bindTable:function(_,A){var $=parseInt(_.getAttribute("jheight")),F=[],H=_.getElementsByTagName("TBODY")[0];if(_.getElementsByTagName("TBODY").length>0)while(H.rows.length>$)H.deleteRow($);if($==0){for(var K in A[0])F[F.length]=K;var B=_.insertRow(_.rows.length);for(var G=0;G<F.length;G++){var E=B.insertCell(B.cells.length);E.innerHTML=F[G]}for(G=0;G<A.length;G++){var C=_.insertRow(_.rows.length),I=A[G];for(K in I){E=C.insertCell(C.cells.length);E.innerHTML=I[K]}}}if($==1){var D=H.rows[0];for(G=0;G<D.cells.length;G++)F[F.length]=D.cells[G].getAttribute("jtext");for(G=0;G<A.length;G++){C=H.insertRow(H.rows.length),I=A[G];for(var J=0;J<F.length;J++){E=C.insertCell(C.cells.length);E.innerHTML=I[F[J]]}}}if($==2){D=H.rows[0];for(G=0;G<D.cells.length;G++)F[F.length]=D.cells[G].getAttribute("jtext");for(G=0;G<A.length;G++){C;if(G==0)C=_.rows[1];else C=_.rows[1].cloneNode(true);if(G>0)H.appendChild(C);I=A[G];for(J=0;J<C.cells.length;J++){E=C.cells[J];E.innerHTML=I[F[J]]}}}if($>=3){D=H.rows[0];for(G=0;G<D.cells.length;G++)F[F.length]=D.cells[G].getAttribute("jtext");for(G=0;G<A.length;G++){C;if(G==0)C=H.rows[1];else if(G==1)C=H.rows[2];else if(G%2==0)C=H.rows[1].cloneNode(true);else if(G%2==1)C=H.rows[2].cloneNode(true);if(G>1)H.appendChild(C);I=A[G];for(J=0;J<C.cells.length;J++){E=C.cells[J];E.innerHTML=I[F[J]]}}}},checkTrue:function($){var _=false;switch(typeof($)){case"boolean":_=$;break;case"string":_=($==true||$=="1"||$=="true"||$=="yes");break;case"number":_=(parseInt($)==1);break;default:_=false}return _}};Buffalo.bind=Buffalo.Bind.bind;Buffalo.View=Class.create();Buffalo.View.LAST_VIEWNAME=null;Buffalo.View.CURRENT_VIEW=null;Buffalo.View.HOME_VIEW=null;Buffalo.View.HISTORY_IFRAME_ID="buffalo-view-history-iframe";Buffalo.View.iframeLoaded=function($){var A=$.href,_=A.indexOf("?"),B="";if(_>-1)B=A.substring(_+1);if(B=="")B=Buffalo.View.HOME_VIEW;if(Buffalo.View.CURRENT_VIEW!=null)Buffalo.View.CURRENT_VIEW.doSwitchPart(B)};Buffalo.View.prototype={initialize:function($){this.buffalo=$},switchPart:function(_,D,F){this.partId=_;this.viewName=D;if(typeof(F)=="undefined"||F==true)this.addToHistory=true;else this.addToHistory=false;if(Buffalo.View.LAST_VIEWNAME==null){Buffalo.View.HOME_VIEW=D;this.doSwitchPart(D);Buffalo.View.LAST_VIEWNAME=D;return}Buffalo.View.CURRENT_VIEW=this;if(this.addToHistory)if($(Buffalo.View.HISTORY_IFRAME_ID)){var E=$(Buffalo.View.HISTORY_IFRAME_ID).src,C=E,B=E.indexOf("?");if(B>-1)C=E.substr(0,B);C+="?"+D;$(Buffalo.View.HISTORY_IFRAME_ID).src=C}else{var A="It seems that you havent add the buffalo-blank.html as an Iframe for browser history.";A+="\nSo this view cannot add to browser history.";A+="\n\nTo prevent this dialog, use buffalo.switchPart(partId, viewName, false) or ";A+="add the buffalo-blank.html to your main page with id 'buffalo-view-history-iframe'.";alert(A)}this.doSwitchPart(D);Buffalo.View.LAST_VIEWNAME=D},doSwitchPart:function(B){if(Buffalo.View.LAST_VIEWNAME==B)return;this.transport=XmlHttp.create();var $=B;try{if(/MSIE/.test(navigator.userAgent)){var A="_bfviewhackkey_="+(new Date()).getTime();if(B.indexOf("?")>-1)$+="&"+A;else $+="?"+A}this.transport.open("GET",$,this.buffalo.async)}catch(C){var _="Buffalo View Error: \n\n Cannot find view with name: "+"["+B+"]";alert(_)}this.transport.send(null);if(this.buffalo.async){this.transport.onreadystatechange=this._viewHandle.bind(this);this.buffalo.events["onLoading"](true)}else this._processView();Buffalo.View.LAST_VIEWNAME=B},_viewHandle:function(){this._processView()},_processView:function(){this.buffalo.events["onLoading"](false);if(this.transport.readyState==4)if(this.transport.status=="200"){var $=this.transport.responseText;this._showView(this.partId,this.viewName,$)}else this.buffalo.events["onError"](this.transport)},_showView:function(C,F,E){var A=/<script(.|\n)*?>(.|\n|\r\n)*?<\/script>/ig,D=/<script(.|\n)*?>((.|\n|\r\n)*)?<\/script>/im;$(C).innerHTML=E.replace(A,"");var G=E.match(A);if(G)for(var _=0;_<G.length;_++){var B=G[_].match(D);this._executeScript(B[2],C)}},_executeScript:function(B,A){var C=A+"_SCRIPT_CONTAINER",_=$(C),E=document.getElementsByTagName("SCRIPT");if(_!=null)document.body.removeChild(_);var D=document.createElement("SCRIPT");D.setAttribute("id",C);D.text=B;document.body.appendChild(D)}};Object.extend(Buffalo.prototype,{switchView:function(_,$){$=$?$:"body";this.switchPart($,_,true)},switchPart:function($,_,A){new Buffalo.View(this).switchPart($,_,A)}});Buffalo.Form={formToBean:function(B,I,C){var E={};if(I)E[Buffalo.BOCLASS]=I;else E[Buffalo.BOCLASS]="java.util.Map";if(typeof(C)=="undefined"||C==true)C=true;else C=false;B=$(B);var K=B.elements;for(var F=0;F<K.length;F++){var D=K[F];if(!D.type)continue;switch(D.type){case"radio":if(D.checked)E[D.name]=D.value;break;case"checkbox":if(!B[D.name].length){if(D.checked)E[D.name]=D.value;else E[D.name]=""}else{if(!E[D.name])E[D.name]=new Array();if(D.checked)E[D.name].push(D.value)}break;case"select-one":var A="",J,_=D.selectedIndex;if(_>=0){J=D.options[_];A=J.value;if(!A&&!("value"in J))A=J.text}E[D.name]=A;break;case"select-multiple":if(!E[D.name])E[D.name]=new Array();for(var H=0;H<D.options.length;H++){J=D.options[H];if(J.selected){var G=J.value;if(!G&&!("value"in J))G=J.text;E[D.name].push(G)}}break;default:if(C){if(D.type!="submit"&&D.type!="button"&&D.type!="reset")E[D.name]=D.value}else E[D.name]=D.value;break}}return E},bindForm:function(C,E){C=$(C);for(var B=0;B<C.elements.length;B++){var _=C.elements[B];if(!E[_.name])continue;var A=E[_.name];switch(_.type){case"text":case"hidden":case"password":_.value=A;break;case"radio":case"checkbox":if(A instanceof Array)_.checked=(A.indexOf(_.value)>-1);else _.checked=(_.value==A);break;case"select-one":case"select-multiple":for(var F=0;F<_.options.length;F++){var D=_.options[F];if(A instanceof Array)D.selected=(A.indexOf(D.value)>-1);else D.selected=(D.value==A)}break}}}}