<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="CustomerDAO">

	<resultMap id="customerMap"
		class="com.china.centet.yongyin.vo.CustomerVO2">
		<result property="id" column="id" />
		<result property="name" column="name" />
		<result property="code" column="code" />
		<result property="connector" column="connector" />
		<result property="stafferName" column="stafferName" />
	</resultMap>

    <!-- in oracle use like '%'||#value#||'%' -->
	<select id="queryAllCustomerByCondtion"
		parameterClass="java.util.Map" resultMap="customerMap">
		select tt2.id , tt2.name , tt2.code , tt2.connector ,tt1.name as stafferName from 
		(
		select t2.STAFFERID, t1.* from t_center_customer_now t1 left join t_center_vs_stacus t2 on (t1.id = t2.CUSTOMERID) where 1 = 1 
		<isNotEmpty prepend="AND" property="name">
			t1.name like CONCAT('%', #name:VARCHAR#,'%') 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="code">
			t1.code like CONCAT('%', #code:VARCHAR#,'%') 
		</isNotEmpty>
		limit 0, 50
		) tt2 left join t_center_oastaffer tt1 on (tt1.id = tt2.STAFFERID)
	</select>

</sqlMap>
