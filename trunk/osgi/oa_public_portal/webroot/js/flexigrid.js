/*
 * Compressed by JSA(www.xidea.org)
 */
var gobal_guid;(function($){$.addFlex=function(t,p){if(t.grid)return false;p=$.extend({height:"auto",width:"auto",striped:true,novstripe:false,minwidth:30,minheight:80,resizable:true,url:false,method:"POST",dataType:"json",usepager:false,nowrap:true,page:1,total:1,currentRows:0,useRp:true,rp:10,rpOptions:[1,10,15,20,25,40],queryMode:0,oprAction:0,queryCondition:null,thisObj:null,connect:null,auth:null,def:null,title:false,callBack:null,cache:1,cacheEle:null,cacheFlag:null,cacheData:null,query:"",qtype:"",minColToggle:1,showToggleBtn:true,hideOnSubmit:true,autoload:true,blockOpacity:0.5,onToggleCol:false,onChangeSort:false,onSuccess:false,rwidth:0,errormsg:Res._Guid["ERRORMSG"],nomsg:Res._Guid["NOMSG"],pagestat:Res._Guid["PAGESTAT"],procmsg:Res._Guid["PROCMSG"],bname:{add:Res._Public["ADD"],del:Res._Public["DEL"],update:Res._Public["UPDATE"],search:Res._Public["SEARCH"]},resource:{refurbish:Res._Guid["REFURBISH"],oprColumns:"",page:Res._Guid["PAGE"],of:Res._Guid["OF"],oprTable:Res._Guid["OPRTABLE"]},onSubmit:false},p);if(p.cache==0){if(p.cacheEle==null)p.cacheEle=document.getElementById("cacheEle");if(p.cacheFlag==null)p.cacheFlag=document.getElementById("cacheFlag")}if(p.height=="page")p.height=((document.documentElement.clientHeight==0)?document.body.clientHeight:document.documentElement.clientHeight)-24*7;$(t).show().attr({cellPadding:0,cellSpacing:0,border:0}).removeAttr("width");var g={hset:{},rePosDrag:function(){var F=0-this.hDiv.scrollLeft;if(this.hDiv.scrollLeft>0)F-=Math.floor(p.cgwidth/2);$(g.cDrag).css({top:g.hDiv.offsetTop+1});var D=this.cdpad;$("div",g.cDrag).hide();var C=p.height,_=p.currentRows,A=(_+4)*24,G=false;if(C<A&&C!="auto")G=true;var B=0;$("thead tr:first th:visible",this.hDiv).each(function(){B++});var E=0;$("thead tr:first th:visible",this.hDiv).each(function(){var C=$("thead tr:first th:visible",g.hDiv).index(this),_=parseInt($("div",this).width());if(E==B-1&&G&&_>18)_=_-18;var A=_;if(F==0)F-=Math.floor(p.cgwidth/2);_=_+F+D;$("div:eq("+C+")",g.cDrag).css({"left":_+"px"}).show();F=_;E++})},fixHeight:function(C){C=false;if(!C)C=$(g.bDiv).height();var _=$(this.hDiv).height();$("div",this.cDrag).each(function(){$(this).height(C+_)});var A=parseInt($(g.nDiv).height());$(g.nDiv).height("auto").width("auto");$(g.block).css({height:C,marginBottom:(C*-1)});var B=g.bDiv.offsetTop+C;if(p.height!="auto"&&p.resizable)B=g.vDiv.offsetTop;$(g.rDiv).css({height:B})},dragStart:function(dragtype,e,obj){if(dragtype=="colresize"){$(g.nDiv).hide();$(g.nBtn).hide();var n=$("div",this.cDrag).index(obj),ow=$("th:visible div:eq("+n+")",this.hDiv).width();$(obj).addClass("dragging").siblings().hide();$(obj).prev().addClass("dragging").show();this.colresize={startX:e.pageX,ol:parseInt(obj.style.left),ow:ow,n:n};$("body").css("cursor","col-resize")}else if(dragtype=="vresize"){var hgo=false;$("body").css("cursor","row-resize");if(obj){hgo=true;$("body").css("cursor","col-resize")}this.vresize={h:p.height,sy:e.pageY,w:p.width,sx:e.pageX,hgo:hgo}}else if(dragtype=="colMove"){$(g.nDiv).hide();$(g.nBtn).hide();this.hset=$(this.hDiv).offset();this.hset.right=this.hset.left+$("table",this.hDiv).width();this.hset.bottom=this.hset.top+$("table",this.hDiv).height();this.dcol=obj;this.dcoln=$("th",this.hDiv).index(obj);this.colCopy=document.createElement("div");this.colCopy.className="colCopy";this.colCopy.innerHTML=obj.innerHTML;if($.browser.msie)this.colCopy.className="colCopy ie";eval("$(this.colCopy).css({position:'absolute',float:'left',display:'none', textAlign: obj.align});");$("body").append(this.colCopy);$(this.cDrag).hide()}$("body").noSelect()},dragMove:function(C){if(this.colresize){var F=this.colresize.n,D=C.pageX-this.colresize.startX,A=this.colresize.ol+D,I=this.colresize.ow+D;if(I>p.minwidth){$("div:eq("+F+")",this.cDrag).css("left",A);this.colresize.nw=I}}else if(this.vresize){var _=this.vresize,H=C.pageY,D=H-_.sy;if(!p.defwidth)p.defwidth=p.width;if(p.width!="auto"&&!p.nohresize&&_.hgo){var J=C.pageX,B=J-_.sx,E=_.w+B;if(E>p.defwidth){this.gDiv.style.width=E+"px";p.width=E}}var G=_.h+D;if((G>p.minheight||p.height<p.minheight)&&!_.hgo){this.bDiv.style.height=G+"px";p.height=G;this.fixHeight(G)}_=null}else if(this.colCopy){$(this.dcol).addClass("thMove").removeClass("thOver");if(C.pageX>this.hset.right||C.pageX<this.hset.left||C.pageY>this.hset.bottom||C.pageY<this.hset.top)$("body").css("cursor","move");else $("body").css("cursor","pointer");$(this.colCopy).css({top:C.pageY+10,left:C.pageX+20,display:"block"})}},dragEnd:function(){if(this.colresize){var _=this.colresize.n,A=this.colresize.nw;$("th:visible div:eq("+_+")",this.hDiv).css("width",A);$("tr",this.bDiv).each(function(){$("td:visible div:eq("+_+")",this).css("width",A)});this.hDiv.scrollLeft=this.bDiv.scrollLeft;$("div:eq("+_+")",this.cDrag).siblings().show();$(".dragging",this.cDrag).removeClass("dragging");this.rePosDrag();this.fixHeight();this.colresize=false}else if(this.vresize)this.vresize=false;else if(this.colCopy){$(this.colCopy).remove();if(this.dcolt!=null){if(this.dcoln>this.dcolt)$("th:eq("+this.dcolt+")",this.hDiv).before(this.dcol);else $("th:eq("+this.dcolt+")",this.hDiv).after(this.dcol);this.switchCol(this.dcoln,this.dcolt);$(this.cdropleft).remove();$(this.cdropright).remove();this.rePosDrag()}this.dcol=null;this.hset=null;this.dcoln=null;this.dcolt=null;this.colCopy=null;$(".thMove",this.hDiv).removeClass("thMove");$(this.cDrag).show()}$("body").css("cursor","default");$("body").noSelect(false)},toggleCol:function(D,A){var C=$("th[axis='col"+D+"']",this.hDiv)[0],B=$("thead th",g.hDiv).index(C),_=$("input[value="+D+"]",g.nDiv)[0];if(A==null)A=C.hide;if($("input:checked",g.nDiv).length<p.minColToggle&&!A)return false;if(A){C.hide=false;$(C).show();_.checked=true}else{C.hide=true;$(C).hide();_.checked=false}$("tbody tr",t).each(function(){if(A)$("td:eq("+B+")",this).show();else $("td:eq("+B+")",this).hide()});this.rePosDrag();if(p.onToggleCol)p.onToggleCol(D,A);return A},switchCol:function(_,A){$("tbody tr",t).each(function(){if(_>A)$("td:eq("+A+")",this).before($("td:eq("+_+")",this));else $("td:eq("+A+")",this).after($("td:eq("+_+")",this))});if(_>A)$("tr:eq("+A+")",this.nDiv).before($("tr:eq("+_+")",this.nDiv));else $("tr:eq("+A+")",this.nDiv).after($("tr:eq("+_+")",this.nDiv));if($.browser.msie&&$.browser.version<7)$("tr:eq("+A+") input",this.nDiv)[0].checked=true;this.hDiv.scrollLeft=this.bDiv.scrollLeft},scroll:function(){this.hDiv.scrollLeft=this.bDiv.scrollLeft;this.rePosDrag()},showError:function(A){$(".pReload",this.pDiv).removeClass("loading");this.loading=false;var _=A.responseText;$(".pPageStat",this.pDiv).html("<font color=red>"+_+"</font>");return false},addData:function(A){if(p.preProcess)A=p.preProcess(A);if(p.cache==0&&window.JSON){p.cacheFlag.value=1;p.cacheEle.value=JSON.stringify(A)}var B=document.getElementById("flexi_Check");if(B)initCheckAll();$(".pReload",this.pDiv).removeClass("loading");this.loading=false;if(!A){$(".pPageStat",this.pDiv).html(p.errormsg);return false}if(p.dataType=="xml")p.total=+$("rows total",A).text();else p.total=A.total;if(p.total==0){$("tr, a, td, div",t).unbind();$(t).empty();p.pages=1;p.page=1;this.buildpager();$(".pPageStat",this.pDiv).html(p.nomsg);return false}p.rp=A.pageSize;p.pages=Math.ceil(p.total/p.rp);if(document.getElementById("rp"))setSelect(document.getElementById("rp"),p.rp);p.oprAction=0;if(p.dataType=="xml")p.page=+$("rows page",A).text();else p.page=A.nowPage;this.buildpager();var _=document.createElement("tbody");if(p.dataType=="json"){p.currentRows=A.rows.length;$.each(A.rows,function(D,C){var A=document.createElement("tr");if(D%2&&p.striped)A.className="erow";if(C.id)A.id="row"+C.id;$("thead tr:first th",g.hDiv).each(function(){var H=document.createElement("td"),E=$(this).attr("axis").substr(3),_=$(this).attr("gid"),J="",M="";if(p.extAtt){var L=p.extAtt[_];if(L){J=parserString(L["begin"],C.cell);M=parserString(L["end"],C.cell)}}H.align=this.align;if($(this).attr("content")){var B=$(this).attr("content");B=parserString(B,C.cell);H.innerHTML=J+B+M}else{var B=C.cell[_],I=$(this).attr("cc"),K=$(this).attr("toFixed");if(I&&p.def){var F=p.def[I];if(F)for(var G=0;G<F.length;G++){var D=F[G];if(D.key==B){B=D.value;break}}}if(K!=undefined)B=parseFloat(B).toFixed(K)+"";H.innerHTML=J+B+M}$(A).append(H);H=null});if($("thead",this.gDiv).length<1)for(idx=0;idx<cell.length;idx++){var B=document.createElement("td");B.innerHTML=C.cell[idx];$(A).append(B);B=null}$(_).append(A);A=null})}else if(p.dataType=="xml"){i=1;$("rows row",A).each(function(){i++;var A=document.createElement("tr");if(i%2&&p.striped)A.className="erow";var B=$(this).attr("id");if(B)A.id="row"+B;B=null;var C=this;$("thead tr:first th",g.hDiv).each(function(){var B=document.createElement("td"),_=$(this).attr("axis").substr(3);B.align=this.align;B.content=this.content;B.innerHTML=$("cell:eq("+_+")",C).text();$(A).append(B);B=null});if($("thead",this.gDiv).length<1)$("cell",this).each(function(){var _=document.createElement("td");_.innerHTML=$(this).text();$(A).append(_);_=null});$(_).append(A);A=null;C=null})}$("tr",t).unbind();$(t).empty();$(t).append(_);this.addCellProp();this.addRowProp();this.fixHeight($(this.bDiv).height());this.rePosDrag();_=null;A=null;i=null;if(p.onSuccess)p.onSuccess();if(p.hideOnSubmit)$(g.block).remove();this.hDiv.scrollLeft=this.bDiv.scrollLeft;if($.browser.opera)$(t).css("visibility","visible");if(p.callBack)p.callBack.apply(null)},changeSort:function(A){if(this.loading)return true;$(g.nDiv).hide();$(g.nBtn).hide();var _=$(A).attr("abbr2")?$(A).attr("abbr2"):$(A).attr("abbr");if(p.sortname==_){if(p.sortorder=="asc")p.sortorder="desc";else p.sortorder="asc"}else p.sortorder="desc";p.oprAction=4;$(A).addClass("sorted").siblings().removeClass("sorted");$(".sdesc",this.hDiv).removeClass("sdesc");$(".sasc",this.hDiv).removeClass("sasc");$("div",A).addClass("s"+p.sortorder);p.sortname=_;if(p.onChangeSort)p.onChangeSort(p.sortname,p.sortorder);else this.populate()},buildpager:function(){$(".pcontrol input",this.pDiv).val(p.page);$(".pcontrol span",this.pDiv).html(p.pages);var _=(p.page-1)*p.rp+1,A=_+p.rp-1;if(p.total<A)A=p.total;var B=p.pagestat;B=B.replace(/{from}/,_);B=B.replace(/{to}/,A);B=B.replace(/{total}/,p.total);$(".pPageStat",this.pDiv).html(B)},populate:function(_){if(this.loading)return true;if(p.onSubmit){var B=p.onSubmit();if(!B)return false}this.loading=true;if(!p.url)return false;$(".pPageStat",this.pDiv).html(p.procmsg);$(".pReload",this.pDiv).addClass("loading");$(g.block).css({top:g.bDiv.offsetTop});if(p.hideOnSubmit)$(this.gDiv).prepend(g.block);if($.browser.opera)$(t).css("visibility","hidden");if(!p.newp)p.newp=1;if(p.page>p.pages)p.page=p.pages;var A=[{name:"nowPage",value:p.newp},{name:"pageSize",value:p.rp},{name:"JSON",value:"JSON"},{name:"sortname",value:p.sortname},{name:"sortorder",value:p.sortorder},{name:"query",value:p.query},{name:"queryMode",value:p.queryMode},{name:"oprAction",value:p.oprAction},{name:"qtype",value:p.qtype}];if(p.queryCondition)for(var D in p.queryCondition){var F={};F["name"]=D;F["value"]=ajaxPararmter(p.queryCondition[D]);A.push(F)}if(p.params)for(var E=0;E<p.params.length;E++)A[A.length]=p.params[E];if(!_&&window.JSON&&p.cache==0&&p.cacheEle&&p.cacheEle.value&&p.cacheFlag&&p.cacheFlag.value==1&&p.oprAction==0){var C=JSON.parse(p.cacheEle.value);g.addData(C)}else{$.ajax({type:p.method,url:p.url,data:A,dataType:p.dataType,success:function($){g.addData($)},error:function(_){try{g.showError(_)}catch($){}}});p.queryCondition=null}},doSearch:function(){p.query=$("input[name=q]",g.sDiv).val();p.qtype=$("select[name=qtype]",g.sDiv).val();p.newp=1;this.populate()},changePage:function(_){if(this.loading)return true;switch(_){case"first":p.newp=1;break;case"prev":if(p.page>1)p.newp=parseInt(p.page)-1;break;case"next":if(p.page<p.pages)p.newp=parseInt(p.page)+1;break;case"last":p.newp=p.pages;break;case"input":var A=parseInt($(".pcontrol input",this.pDiv).val());if(isNaN(A))A=1;if(A<1)A=1;else if(A>p.pages)A=p.pages;$(".pcontrol input",this.pDiv).val(A);p.newp=A;break}p.oprAction=2;if(p.newp==p.page)return false;if(p.onChangePage)p.onChangePage(p.newp);else this.populate()},addCellProp:function(){var C=p.height,_=p.currentRows,A=(_+4)*24,E=false;if(C<A&&C!="auto");var B=0;$("thead tr:first th:visible",this.hDiv).each(function(){B++});B=B-1;var D=0;$("tbody tr td",g.bDiv).each(function(){var I=document.createElement("div"),F=$("td",$(this).parent()).index(this),A=$("th:eq("+F+")",g.hDiv).get(0);if(A!=null){if(p.sortname==$(A).attr("abbr")&&p.sortname)this.className="sorted";var H=$("div:first",A)[0].style.width;if(E&&D==B){var C=0;if(H.indexOf("px")!=-1)C=parseInt(H.substring(0,H.length-2));else C=parseInt(H+"");C=C-18;if(H.indexOf("px")!=-1)H=C+"px";else H=C;D=-1}$(I).css({textAlign:A.align,width:H});if(A.hide)$(this).css("display","none")}if(p.nowrap==false)$(I).css("white-space","normal");if(this.innerHTML=="")this.innerHTML="&nbsp;";I.innerHTML=this.innerHTML;var _=$(this).parent()[0],G=false;if(_.id)G=_.id.substr(3);if(A!=null)if(A.process)A.process(I,G);$(this).empty().append(I).removeAttr("width");D++})},getCellDim:function(E){var B=parseInt($(E).height()),_=parseInt($(E).parent().height()),G=parseInt(E.style.width),A=parseInt($(E).parent().width()),H=E.offsetParent.offsetTop,D=E.offsetParent.offsetLeft,F=parseInt($(E).css("paddingLeft")),C=parseInt($(E).css("paddingTop"));return{ht:B,wt:G,top:H,left:D,pdl:F,pdt:C,pht:_,pwt:A}},addRowProp:function(){$("tbody tr",g.bDiv).each(function(){$(this).click(function(_){var A=(_.target||_.srcElement);if(A.href||A.type)return true;$(this).toggleClass("trSelected");if(p.singleSelect)$(this).siblings().removeClass("trSelected")}).mousedown(function(_){if(_.shiftKey){$(this).toggleClass("trSelected");g.multisel=true;this.focus();$(g.gDiv).noSelect()}}).mouseup(function(){if(g.multisel){g.multisel=false;$(g.gDiv).noSelect(false)}}).hover(function(_){if(g.multisel)$(this).toggleClass("trSelected")},function(){});if($.browser.msie&&$.browser.version<7)$(this).hover(function(){$(this).addClass("trOver")},function(){$(this).removeClass("trOver")})})},pager:0};if(p.colModel){thead=document.createElement("thead");tr=document.createElement("tr");var widthArray=[],pageWidth=0;if(p.width=="auto")pageWidth=document.body.offsetWidth-(p.colModel.length-2)*13+(p.colModel.length-3)*1-p.rwidth-25;else pageWidth=p.width-(p.colModel.length-2)*13+(p.colModel.length-3)*1-25;var autoIndex=-1,auto2=0,totalWidth=0;for(i=0;i<p.colModel.length;i++){var cm=p.colModel[i];widthArray[i]=0;if(cm.width)if((cm.width+"").indexOf("%")!=-1){var wh=parseInt(cm.width.substring(0,cm.width.length-1));widthArray[i]=Math.ceil(pageWidth*wh/100)-1}else if(cm.width=="auto")autoIndex=i;else if(cm.width=="auto2"){autoIndex=i;auto2=1}else widthArray[i]=cm.width;totalWidth+=parseInt(widthArray[i]+"")}if(autoIndex!=-1){var autoWidth=pageWidth-totalWidth;if(autoWidth<=0)autoWidth=100;if(auto2==0)widthArray[autoIndex]=autoWidth;else widthArray[autoIndex]=autoWidth-18}for(i=0;i<p.colModel.length;i++){var cm=p.colModel[i],th=document.createElement("th");th.innerHTML=cm.display;if(cm.cname&&cm.sortable)$(th).attr("abbr2",cm.cname);if(cm.name&&cm.sortable)$(th).attr("abbr",cm.name);$(th).attr("gid",cm.name);$(th).attr("axis","col"+i);$(th).attr("content",cm.content);if(cm.cc)$(th).attr("cc",cm.cc);if(cm.toFixed)$(th).attr("toFixed",cm.toFixed);if(cm.align)th.align=cm.align;if(cm.width)$(th).attr("width",widthArray[i]);if(cm.hide)th.hide=true;if(cm.process)th.process=cm.process;$(tr).append(th)}$(thead).append(tr);$(t).prepend(thead)}g.gDiv=document.createElement("div");g.mDiv=document.createElement("div");g.hDiv=document.createElement("div");g.bDiv=document.createElement("div");g.vDiv=document.createElement("div");g.rDiv=document.createElement("div");g.cDrag=document.createElement("div");g.block=document.createElement("div");g.nDiv=document.createElement("div");g.nBtn=document.createElement("div");g.iDiv=document.createElement("div");g.tDiv=document.createElement("div");g.sDiv=document.createElement("div");if(p.usepager)g.pDiv=document.createElement("div");g.hTable=document.createElement("table");g.gDiv.className="flexigrid";if(p.width!="auto")g.gDiv.style.width=p.width+"px";else g.gDiv.style.width=(document.body.offsetWidth-p.rwidth)+"px";if($.browser.msie)$(g.gDiv).addClass("ie");if(p.novstripe)$(g.gDiv).addClass("novstripe");$(t).before(g.gDiv);$(g.gDiv).append(t);if(p.buttons){g.tDiv.className="tDiv";var tDiv2=document.createElement("div");tDiv2.className="tDiv2";for(i=0;i<p.buttons.length;i++){var btn=p.buttons[i],dis=true;if((btn.auth&&p.auth)||(btn.auth==false&&p.auth)||(btn.auth=="false"&&p.auth)){var hasAuth=false;if(btn.auth==true||btn.auth=="true")hasAuth=true;else if(btn.auth==false||btn.auth=="false")hasAuth=false;else{var aauths=btn.auth.split(",");for(var m=0;m<p.auth.length;m++){for(var n=0;n<aauths.length;n++)if(aauths[n]==p.auth[m]){hasAuth=true;break}if(hasAuth==true)break}}dis=hasAuth}if(!btn.separator){if(dis){var btnDiv=document.createElement("div");btnDiv.className="fbutton";if(btn.caption)btnDiv.innerHTML="<div id=b_"+btn.id+"><span id=s_"+btn.id+">"+btn.caption+"</span></div>";else btnDiv.innerHTML="<div id=b_"+btn.id+"><span id=s_"+btn.id+">"+p.bname[btn.id.toLowerCase()]+"</span></div>";if(btn.bclass)$("span",btnDiv).addClass(btn.bclass).css({paddingLeft:20});btnDiv.onpress=btn.onpress;btnDiv.id=btn.id;if(btn.onpress)$(btnDiv).click(function(){this.onpress(this.id,g.gDiv)});$(tDiv2).append(btnDiv);if($.browser.msie&&$.browser.version<7)$(btnDiv).hover(function(){$(this).addClass("fbOver")},function(){$(this).removeClass("fbOver")});$(tDiv2).append("<div class='btnseparator'></div>")}}else $(tDiv2).append("<div class='btnseparator'></div>")}$(g.tDiv).append(tDiv2);$(g.tDiv).append("<div style='clear:both'></div>");$(g.gDiv).prepend(g.tDiv)}g.hDiv.className="hDiv";$(t).before(g.hDiv);g.hTable.cellPadding=0;g.hTable.cellSpacing=0;$(g.hDiv).append("<div class=\"hDivBox\"></div>");$("div",g.hDiv).append(g.hTable);var thead=$("thead:first",t).get(0);if(thead)$(g.hTable).append(thead);thead=null;if(!p.colmodel)var ci=0;$("thead tr:first th",g.hDiv).each(function(){var _=document.createElement("div");if($(this).attr("abbr")){$(this).click(function(_){if(!$(this).hasClass("thOver"))return false;var A=(_.target||_.srcElement);if(A.href||A.type)return true;g.changeSort(this)});if($(this).attr("abbr")==p.sortname){this.className="sorted";_.className="s"+p.sortorder}}if(this.hide)$(this).hide();if(!p.colmodel)$(this).attr("axis","col"+ci++);$(_).css({textAlign:this.align,width:this.width+"px"});_.innerHTML=this.innerHTML;$(this).empty().append(_).removeAttr("width").mousedown(function($){g.dragStart("colMove",$,this)}).hover(function(){if(!g.colresize&&!$(this).hasClass("thMove")&&!g.colCopy)$(this).addClass("thOver");if($(this).attr("abbr")!=p.sortname&&!g.colCopy&&!g.colresize&&$(this).attr("abbr"))$("div",this).addClass("s"+p.sortorder);else if($(this).attr("abbr")==p.sortname&&!g.colCopy&&!g.colresize&&$(this).attr("abbr")){var A="";if(p.sortorder=="asc")A="desc";else A="asc";$("div",this).removeClass("s"+p.sortorder).addClass("s"+A)}if(g.colCopy){var B=$("th",g.hDiv).index(this);if(B==g.dcoln)return false;if(B<g.dcoln)$(this).append(g.cdropleft);else $(this).append(g.cdropright);g.dcolt=B}else if(!g.colresize){var E=$("th:visible",g.hDiv).index(this),C=parseInt($("div:eq("+E+")",g.cDrag).css("left")),D=parseInt($(g.nBtn).width())+parseInt($(g.nBtn).css("borderLeftWidth"));nl=C-D+Math.floor(p.cgwidth/2);$(g.nDiv).hide();$(g.nBtn).hide();$(g.nBtn).css({"left":nl,top:g.hDiv.offsetTop}).show();var _=parseInt($(g.nDiv).width());$(g.nDiv).css({top:g.bDiv.offsetTop});if((nl+_)>$(g.gDiv).width())$(g.nDiv).css("left",C-_+1);else $(g.nDiv).css("left",nl);if($(this).hasClass("sorted"))$(g.nBtn).addClass("srtd");else $(g.nBtn).removeClass("srtd")}},function(){$(this).removeClass("thOver");if($(this).attr("abbr")!=p.sortname)$("div",this).removeClass("s"+p.sortorder);else if($(this).attr("abbr")==p.sortname){var _="";if(p.sortorder=="asc")_="desc";else _="asc";$("div",this).addClass("s"+p.sortorder).removeClass("s"+_)}if(g.colCopy){$(g.cdropleft).remove();$(g.cdropright).remove();g.dcolt=null}})});g.bDiv.className="bDiv";$(t).before(g.bDiv);$(g.bDiv).css({height:(p.height=="auto")?"auto":p.height+"px"}).scroll(function($){g.scroll()}).append(t);if(p.height=="auto")$("table",g.bDiv).addClass("autoht");g.addCellProp();g.addRowProp();var cdcol=$("thead tr:first th:first",g.hDiv).get(0);if(cdcol!=null){g.cDrag.className="cDrag";g.cdpad=0;g.cdpad+=(isNaN(parseInt($("div",cdcol).css("borderLeftWidth")))?0:parseInt($("div",cdcol).css("borderLeftWidth")));g.cdpad+=(isNaN(parseInt($("div",cdcol).css("borderRightWidth")))?0:parseInt($("div",cdcol).css("borderRightWidth")));g.cdpad+=(isNaN(parseInt($("div",cdcol).css("paddingLeft")))?0:parseInt($("div",cdcol).css("paddingLeft")));g.cdpad+=(isNaN(parseInt($("div",cdcol).css("paddingRight")))?0:parseInt($("div",cdcol).css("paddingRight")));g.cdpad+=(isNaN(parseInt($(cdcol).css("borderLeftWidth")))?0:parseInt($(cdcol).css("borderLeftWidth")));g.cdpad+=(isNaN(parseInt($(cdcol).css("borderRightWidth")))?0:parseInt($(cdcol).css("borderRightWidth")));g.cdpad+=(isNaN(parseInt($(cdcol).css("paddingLeft")))?0:parseInt($(cdcol).css("paddingLeft")));g.cdpad+=(isNaN(parseInt($(cdcol).css("paddingRight")))?0:parseInt($(cdcol).css("paddingRight")));$(g.bDiv).before(g.cDrag);var cdheight=$(g.bDiv).height(),hdheight=$(g.hDiv).height();$(g.cDrag).css({top:-hdheight+"px"});$("thead tr:first th",g.hDiv).each(function(){var _=document.createElement("div");$(g.cDrag).append(_);if(!p.cgwidth)p.cgwidth=$(_).width();$(_).css({height:cdheight+hdheight}).mousedown(function($){g.dragStart("colresize",$,this)});if($.browser.msie&&$.browser.version<7){g.fixHeight($(g.gDiv).height());$(_).hover(function(){g.fixHeight();$(this).addClass("dragging")},function(){if(!g.colresize)$(this).removeClass("dragging")})}})}if(p.striped)$("tbody tr:odd",g.bDiv).addClass("erow");if(p.resizable&&p.height!="auto"){g.vDiv.className="vGrip";$(g.vDiv).mousedown(function($){g.dragStart("vresize",$)}).html("<span></span>");$(g.bDiv).after(g.vDiv)}if(p.resizable&&p.width!="auto"&&!p.nohresize){g.rDiv.className="hGrip";$(g.rDiv).mousedown(function($){g.dragStart("vresize",$,true)}).html("<span></span>").css("height",$(g.gDiv).height());if($.browser.msie&&$.browser.version<7)$(g.rDiv).hover(function(){$(this).addClass("hgOver")},function(){$(this).removeClass("hgOver")});$(g.gDiv).append(g.rDiv)}if(p.usepager){g.pDiv.className="pDiv";g.pDiv.innerHTML="<div class=\"pDiv2\"></div>";$(g.bDiv).after(g.pDiv);var html=" <div class=\"pGroup\"> <div class=\"pFirst pButton\"><span></span></div><div class=\"pPrev pButton\"><span></span></div> </div> <div class=\"btnseparator\"></div> <div class=\"pGroup\"><span class=\"pcontrol\">"+p.resource["page"]+" <input type=\"text\" size=\"4\" value=\"1\" /> "+p.resource["of"]+" <span> 1 </span></span></div> <div class=\"btnseparator\"></div> <div class=\"pGroup\"> <div class=\"pNext pButton\"><span></span></div><div class=\"pLast pButton\"><span></span></div> </div> <div class=\"btnseparator\"></div> <div class=\"pGroup\"> <div class=\"pReload pButton\" title=\""+p.resource["refurbish"]+"\"><span></span></div> </div> <div class=\"btnseparator\"></div> <div class=\"pGroup\"><span class=\"pPageStat\"></span></div>";$("div",g.pDiv).html(html);$(".pReload",g.pDiv).click(function(){p.oprAction=3;g.populate()});$(".pFirst",g.pDiv).click(function(){g.changePage("first")});$(".pPrev",g.pDiv).click(function(){g.changePage("prev")});$(".pNext",g.pDiv).click(function(){g.changePage("next")});$(".pLast",g.pDiv).click(function(){g.changePage("last")});$(".pcontrol input",g.pDiv).keydown(function($){if($.keyCode==13)g.changePage("input")});if($.browser.msie&&$.browser.version<7)$(".pButton",g.pDiv).hover(function(){$(this).addClass("pBtnOver")},function(){$(this).removeClass("pBtnOver")});if(p.useRp){var opt="";for(var nx=0;nx<p.rpOptions.length;nx++){if(p.rp==p.rpOptions[nx])sel="selected=\"selected\"";else sel="";opt+="<option value='"+p.rpOptions[nx]+"' "+sel+" >"+p.rpOptions[nx]+"&nbsp;&nbsp;</option>"}$(".pDiv2",g.pDiv).prepend("<div class='pGroup'><select name='rp' id='rp'>"+opt+"</select></div> <div class='btnseparator'></div>");$("select",g.pDiv).change(function(){p.oprAction=1;if(p.onRpChange)p.onRpChange(+this.value);else{p.newp=1;p.rp=+this.value;g.populate()}})}if(p.searchitems){$(".pDiv2",g.pDiv).prepend("<div class='pGroup'> <div class='pSearch pButton'><span></span></div> </div>  <div class='btnseparator'></div>");$(".pSearch",g.pDiv).click(function(){$(g.sDiv).slideToggle("fast",function(){$(".sDiv:visible input:first",g.gDiv).trigger("focus")})});g.sDiv.className="sDiv";sitems=p.searchitems;var sopt="";for(var s=0;s<sitems.length;s++){if(p.qtype==""&&sitems[s].isdefault==true){p.qtype=sitems[s].name;sel="selected=\"selected\""}else sel="";sopt+="<option value='"+sitems[s].name+"' "+sel+" >"+sitems[s].display+"&nbsp;&nbsp;</option>"}if(p.qtype=="")p.qtype=sitems[0].name;$(g.sDiv).append("<div class='sDiv2'>Quick Search <input type='text' size='30' name='q' class='qsbox' /> <select name='qtype'>"+sopt+"</select> <input type='button' value='Clear' /></div>");$("input[name=q],select[name=qtype]",g.sDiv).keydown(function($){if($.keyCode==13)g.doSearch()});$("input[value=Clear]",g.sDiv).click(function(){$("input[name=q]",g.sDiv).val("");p.query="";g.doSearch()});$(g.bDiv).after(g.sDiv)}}$(g.pDiv,g.sDiv).append("<div style='clear:both'></div>");if(p.title){g.mDiv.className="mDiv";g.mDiv.innerHTML="<div class=\"ftitle\">"+p.title+"</div>";$(g.gDiv).prepend(g.mDiv);if(p.showTableToggleBtn){$(g.mDiv).append("<div class=\"ptogtitle\" title=\""+p.resource["oprTable"]+"\"><span></span></div>");$("div.ptogtitle",g.mDiv).click(function(){$(g.gDiv).toggleClass("hideBody");$(this).toggleClass("vsble")})}}g.cdropleft=document.createElement("span");g.cdropleft.className="cdropleft";g.cdropright=document.createElement("span");g.cdropright.className="cdropright";g.block.className="gBlock";var gh=$(g.bDiv).height(),gtop=g.bDiv.offsetTop;$(g.block).css({width:g.bDiv.style.width,height:gh,background:"white",position:"relative",marginBottom:(gh*-1),zIndex:1,top:gtop,left:"0px"});$(g.block).fadeTo(0,p.blockOpacity);if($("th",g.hDiv).length){g.nDiv.className="nDiv";g.nDiv.innerHTML="<table cellpadding='0' cellspacing='0'><tbody></tbody></table>";$(g.nDiv).css({marginBottom:(gh*-1),display:"none",top:gtop}).noSelect();var cn=0;$("th div",g.hDiv).each(function(){var A=$("th[axis='col"+cn+"']",g.hDiv)[0],_="checked=\"checked\"";if(A.style.display=="none")_="";$("tbody",g.nDiv).append("<tr><td class=\"ndcol1\"><input type=\"checkbox\" "+_+" class=\"togCol\" value=\""+cn+"\" /></td><td class=\"ndcol2\">"+this.innerHTML+"</td></tr>");cn++});if($.browser.msie&&$.browser.version<7)$("tr",g.nDiv).hover(function(){$(this).addClass("ndcolover")},function(){$(this).removeClass("ndcolover")});$("td.ndcol2",g.nDiv).click(function(){if($("input:checked",g.nDiv).length<=p.minColToggle&&$(this).prev().find("input")[0].checked)return false;return g.toggleCol($(this).prev().find("input").val())});$("input.togCol",g.nDiv).click(function(){if($("input:checked",g.nDiv).length<p.minColToggle&&this.checked==false)return false;$(this).parent().next().trigger("click")});$(g.gDiv).prepend(g.nDiv);$(g.nBtn).addClass("nBtn").html("<div></div>").attr("title",p.resource["oprColumns"]).click(function(){$(g.nDiv).toggle();return true});if(p.showToggleBtn)$(g.gDiv).prepend(g.nBtn)}$(g.iDiv).addClass("iDiv").css({display:"none"});$(g.bDiv).append(g.iDiv);$(g.bDiv).hover(function(){$(g.nDiv).hide();$(g.nBtn).hide()},function(){if(g.multisel)g.multisel=false});$(g.gDiv).hover(function(){},function(){$(g.nDiv).hide();$(g.nBtn).hide()});$(document).mousemove(function($){g.dragMove($)}).mouseup(function($){g.dragEnd()}).hover(function(){},function(){g.dragEnd()});if($.browser.msie&&$.browser.version<7){$(".hDiv,.bDiv,.mDiv,.pDiv,.vGrip,.tDiv, .sDiv",g.gDiv).css({width:"100%"});$(g.gDiv).addClass("ie6");if(p.width!="auto")$(g.gDiv).addClass("ie6fullwidthbug")}g.rePosDrag();g.fixHeight();t.p=p;t.grid=g;if(p.url&&p.autoload)g.populate();return t};var docloaded=false;$(document).ready(function(){docloaded=true});$.fn.flexigrid=function(_){return this.each(function(){if(!docloaded){$(this).hide();var A=this;$(document).ready(function(){gobal_guid=$.addFlex(A,_)})}else gobal_guid=$.addFlex(this,_)})};$.fn.flexReload=function($){return this.each(function(){if(this.grid&&this.p.url)this.grid.populate()})};$.fn.flexOptions=function(_){return this.each(function(){if(this.grid)$.extend(this.p,_)})};$.fn.flexToggleCol=function(_,$){return this.each(function(){if(this.grid)this.grid.toggleCol(_,$)})};$.fn.flexAddData=function($){return this.each(function(){if(this.grid)this.grid.addData($)})};$.fn.noSelect=function(_){if(_==null)prevent=true;else prevent=_;if(prevent)return this.each(function(){if($.browser.msie||$.browser.safari)$(this).bind("selectstart",function(){return false});else if($.browser.mozilla){$(this).css("MozUserSelect","none");$("body").trigger("focus")}else if($.browser.opera)$(this).bind("mousedown",function(){return false});else $(this).attr("unselectable","on")});else return this.each(function(){if($.browser.msie||$.browser.safari)$(this).unbind("selectstart");else if($.browser.mozilla)$(this).css("MozUserSelect","inherit");else if($.browser.opera)$(this).unbind("mousedown");else $(this).removeAttr("unselectable","on")})}})(jQuery);function parserString($,_){var A=$;while(true){A=getSplit($,_);if(A==$)return A;$=A}}function getSplit($,B){var _=$.indexOf("{");if(_==-1)return $;var C=$.indexOf("}");if(C==-1)return $;if(C<$.length-1)var D=$.substring(C+1);var E=$.substring(_+1,C),A=B[E];if(A!=null&&A!=undefined)$=$.replace("{"+E+"}",A.toString());return $}function setSelect(C,_){if(!C)return;var B=_;if(!isNoneInCommon(B)){var $=C.options;for(var A=0;A<$.length;A++)if($[A].value==B){$[A].selected=true;return true}}return false}function isNoneInCommon($){if(typeof $=="string")if($=="")return true;return false}function $ajax(_,A,B){$.ajax({type:"POST",url:_,data:[],dataType:"json",success:A,error:B?B:function($){alert("system error")}})}function $ajax2(A,_,B,C){$.ajax({type:"POST",url:A,data:_,dataType:"json",success:B,error:C?C:function($){alert("system error")}})}function commonQuery($){gobal_guid.p.queryCondition=$;gobal_guid.grid.populate(true)}function ajaxPararmter($){$=$.replace(/\+/g,"%2B");$=$.replace(/\%/g,"%25");$=$.replace(/\&/g,"%26");return $}function checkAll(A){var _=A.checked,$=document.getElementsByTagName("input");for(var B=0;B<$.length;B++)if($[B].type.toLowerCase()=="checkbox"&&$[B].name=="checkb")$[B].checked=_}function initCheckAll(){var $=document.getElementsByTagName("input");for(var _=0;_<$.length;_++)if($[_].type.toLowerCase()=="checkbox"&&$[_].id=="flexi_Check")$[_].checked=false}var DEFAULT_HEIGHT=330