<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="WorkLogDAO">

	<resultMap id="wrapMap"
		class="com.china.center.oa.worklog.wrap.StatWorkLogWrap">
		<result property="stafferId" column="stafferId" />
		<result property="stafferName" column="stafferName" />
		<result property="total" column="total" />
	</resultMap>

	<select id="queryStatWorkLogWrap" parameterClass="java.util.Map"
		resultMap="wrapMap">
		select t1.stafferId, t2.name as stafferName, count(1) as total
		from T_CENTER_WORKLOG t1, T_CENTER_OASTAFFER t2 where
		t1.stafferid = t2.id and t1.workDate &gt;= #beginDate# and t1.status = #status#
		<isNotEmpty prepend="AND" property="endDate">
            t1.workDate &lt;= #endDate#
        </isNotEmpty>
		<isNotEmpty prepend="AND" property="stafferId">
			t1.stafferId = #stafferId#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="locationId">
			t2.locationId = #locationId#
		</isNotEmpty>
		group by t1.stafferid
	</select>

</sqlMap>
